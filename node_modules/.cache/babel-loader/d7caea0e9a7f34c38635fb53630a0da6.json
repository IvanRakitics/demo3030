{"ast":null,"code":"import React, { useRef } from 'react';\nimport classNames from 'classnames';\nimport { useSpring, animated } from '@react-spring/web';\nimport { withNativeProps } from '../../utils/native-props';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport { bound } from '../../utils/bound';\nimport { useThrottleFn, useIsomorphicLayoutEffect } from 'ahooks';\nimport { useMutationEffect } from '../../utils/use-mutation-effect';\nimport { useResizeEffect } from '../../utils/use-resize-effect';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { useIsomorphicUpdateLayoutEffect } from '../../utils/use-isomorphic-update-layout-effect';\nimport { ShouldRender } from '../../utils/should-render';\nconst classPrefix = `adm-tabs`;\nexport const Tab = () => {\n  return null;\n};\nconst defaultProps = {\n  activeLineMode: 'auto',\n  stretch: true\n};\nexport const Tabs = p => {\n  var _a;\n\n  const props = mergeProps(defaultProps, p);\n  const tabListContainerRef = useRef(null);\n  const activeLineRef = useRef(null);\n  const keyToIndexRecord = {};\n  let firstActiveKey = null;\n  const panes = [];\n  React.Children.forEach(props.children, (child, index) => {\n    if (!React.isValidElement(child)) return;\n    const key = child.key;\n    if (typeof key !== 'string') return;\n\n    if (index === 0) {\n      firstActiveKey = key;\n    }\n\n    const length = panes.push(child);\n    keyToIndexRecord[key] = length - 1;\n  });\n  const [activeKey, setActiveKey] = usePropsValue({\n    value: props.activeKey,\n    defaultValue: (_a = props.defaultActiveKey) !== null && _a !== void 0 ? _a : firstActiveKey,\n    onChange: v => {\n      var _a;\n\n      if (v === null) return;\n      (_a = props.onChange) === null || _a === void 0 ? void 0 : _a.call(props, v);\n    }\n  });\n  const [{\n    x,\n    width\n  }, api] = useSpring(() => ({\n    x: 0,\n    width: 0,\n    config: {\n      tension: 300,\n      clamp: true\n    }\n  }));\n  const [{\n    scrollLeft\n  }, scrollApi] = useSpring(() => ({\n    scrollLeft: 0,\n    config: {\n      tension: 300,\n      clamp: true\n    }\n  }));\n  const [{\n    leftMaskOpacity,\n    rightMaskOpacity\n  }, maskApi] = useSpring(() => ({\n    leftMaskOpacity: 0,\n    rightMaskOpacity: 0,\n    config: {\n      clamp: true\n    }\n  }));\n\n  function animate() {\n    let immediate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    const container = tabListContainerRef.current;\n    if (!container) return;\n    const activeIndex = keyToIndexRecord[activeKey];\n\n    if (activeIndex === undefined) {\n      api.start({\n        x: 0,\n        width: 0,\n        immediate: true\n      });\n      return;\n    }\n\n    const activeLine = activeLineRef.current;\n    if (!activeLine) return;\n    const activeTabWrapper = container.children.item(activeIndex + 1);\n    const activeTab = activeTabWrapper.children.item(0);\n    const activeTabLeft = activeTab.offsetLeft;\n    const activeTabWidth = activeTab.offsetWidth;\n    const activeTabWrapperLeft = activeTabWrapper.offsetLeft;\n    const activeTabWrapperWidth = activeTabWrapper.offsetWidth;\n    const containerWidth = container.offsetWidth;\n    const containerScrollWidth = container.scrollWidth;\n    const containerScrollLeft = container.scrollLeft;\n    const activeLineWidth = activeLine.offsetWidth;\n    let x = 0;\n    let width = 0;\n\n    if (props.activeLineMode === 'auto') {\n      x = activeTabLeft;\n      width = activeTabWidth;\n    } else if (props.activeLineMode === 'full') {\n      x = activeTabWrapperLeft;\n      width = activeTabWrapperWidth;\n    } else {\n      x = activeTabLeft + (activeTabWidth - activeLineWidth) / 2;\n    }\n\n    api.start({\n      x,\n      width,\n      immediate\n    });\n    const maxScrollDistance = containerScrollWidth - containerWidth;\n    if (maxScrollDistance <= 0) return;\n    const nextScrollLeft = bound(activeTabLeft - (containerWidth - activeTabWidth) / 2, 0, containerScrollWidth - containerWidth);\n    scrollApi.start({\n      scrollLeft: nextScrollLeft,\n      from: {\n        scrollLeft: containerScrollLeft\n      },\n      immediate\n    });\n  }\n\n  useIsomorphicLayoutEffect(() => {\n    animate(!x.isAnimating);\n  }, []);\n  useIsomorphicUpdateLayoutEffect(() => {\n    animate();\n  }, [activeKey]);\n  useResizeEffect(() => {\n    animate(!x.isAnimating);\n  }, tabListContainerRef);\n  useMutationEffect(() => {\n    animate(!x.isAnimating);\n  }, tabListContainerRef, {\n    subtree: true,\n    childList: true,\n    characterData: true\n  });\n  const {\n    run: updateMask\n  } = useThrottleFn(function () {\n    let immediate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    const container = tabListContainerRef.current;\n    if (!container) return;\n    const scrollLeft = container.scrollLeft;\n    const showLeftMask = scrollLeft > 0;\n    const showRightMask = scrollLeft + container.offsetWidth < container.scrollWidth;\n    maskApi.start({\n      leftMaskOpacity: showLeftMask ? 1 : 0,\n      rightMaskOpacity: showRightMask ? 1 : 0,\n      immediate\n    });\n  }, {\n    wait: 100,\n    trailing: true,\n    leading: true\n  });\n  useIsomorphicLayoutEffect(() => {\n    updateMask(true);\n  }, []);\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classPrefix\n  }, React.createElement(\"div\", {\n    className: `${classPrefix}-header`\n  }, React.createElement(animated.div, {\n    className: classNames(`${classPrefix}-header-mask`, `${classPrefix}-header-mask-left`),\n    style: {\n      opacity: leftMaskOpacity\n    }\n  }), React.createElement(animated.div, {\n    className: classNames(`${classPrefix}-header-mask`, `${classPrefix}-header-mask-right`),\n    style: {\n      opacity: rightMaskOpacity\n    }\n  }), React.createElement(animated.div, {\n    className: `${classPrefix}-tab-list`,\n    ref: tabListContainerRef,\n    scrollLeft: scrollLeft,\n    onScroll: updateMask\n  }, React.createElement(animated.div, {\n    ref: activeLineRef,\n    className: `${classPrefix}-tab-line`,\n    style: {\n      width: props.activeLineMode === 'fixed' ? 'var(--fixed-active-line-width, 30px)' : width,\n      x\n    }\n  }), panes.map(pane => withNativeProps(pane.props, React.createElement(\"div\", {\n    key: pane.key,\n    className: classNames(`${classPrefix}-tab-wrapper`, {\n      [`${classPrefix}-tab-wrapper-stretch`]: props.stretch\n    })\n  }, React.createElement(\"div\", {\n    onClick: () => {\n      const {\n        key\n      } = pane;\n      if (pane.props.disabled) return;\n\n      if (key === undefined || key === null) {\n        return;\n      }\n\n      setActiveKey(key.toString());\n    },\n    className: classNames(`${classPrefix}-tab`, {\n      [`${classPrefix}-tab-active`]: pane.key === activeKey,\n      [`${classPrefix}-tab-disabled`]: pane.props.disabled\n    })\n  }, pane.props.title)))))), panes.map(pane => {\n    if (pane.props.children === undefined) {\n      return null;\n    }\n\n    const active = pane.key === activeKey;\n    return React.createElement(ShouldRender, {\n      key: pane.key,\n      active: active,\n      forceRender: pane.props.forceRender,\n      destroyOnClose: pane.props.destroyOnClose\n    }, React.createElement(\"div\", {\n      className: `${classPrefix}-content`,\n      style: {\n        display: active ? 'block' : 'none'\n      }\n    }, pane.props.children));\n  })));\n};","map":{"version":3,"sources":["D:/react/project0330/node_modules/antd-mobile/es/components/tabs/tabs.js"],"names":["React","useRef","classNames","useSpring","animated","withNativeProps","usePropsValue","bound","useThrottleFn","useIsomorphicLayoutEffect","useMutationEffect","useResizeEffect","mergeProps","useIsomorphicUpdateLayoutEffect","ShouldRender","classPrefix","Tab","defaultProps","activeLineMode","stretch","Tabs","p","_a","props","tabListContainerRef","activeLineRef","keyToIndexRecord","firstActiveKey","panes","Children","forEach","children","child","index","isValidElement","key","length","push","activeKey","setActiveKey","value","defaultValue","defaultActiveKey","onChange","v","call","x","width","api","config","tension","clamp","scrollLeft","scrollApi","leftMaskOpacity","rightMaskOpacity","maskApi","animate","immediate","container","current","activeIndex","undefined","start","activeLine","activeTabWrapper","item","activeTab","activeTabLeft","offsetLeft","activeTabWidth","offsetWidth","activeTabWrapperLeft","activeTabWrapperWidth","containerWidth","containerScrollWidth","scrollWidth","containerScrollLeft","activeLineWidth","maxScrollDistance","nextScrollLeft","from","isAnimating","subtree","childList","characterData","run","updateMask","showLeftMask","showRightMask","wait","trailing","leading","createElement","className","div","style","opacity","ref","onScroll","map","pane","onClick","disabled","toString","title","active","forceRender","destroyOnClose","display"],"mappings":"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","sourcesContent":["import React, { useRef } from 'react';\nimport classNames from 'classnames';\nimport { useSpring, animated } from '@react-spring/web';\nimport { withNativeProps } from '../../utils/native-props';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport { bound } from '../../utils/bound';\nimport { useThrottleFn, useIsomorphicLayoutEffect } from 'ahooks';\nimport { useMutationEffect } from '../../utils/use-mutation-effect';\nimport { useResizeEffect } from '../../utils/use-resize-effect';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { useIsomorphicUpdateLayoutEffect } from '../../utils/use-isomorphic-update-layout-effect';\nimport { ShouldRender } from '../../utils/should-render';\nconst classPrefix = `adm-tabs`;\nexport const Tab = () => {\n  return null;\n};\nconst defaultProps = {\n  activeLineMode: 'auto',\n  stretch: true\n};\nexport const Tabs = p => {\n  var _a;\n\n  const props = mergeProps(defaultProps, p);\n  const tabListContainerRef = useRef(null);\n  const activeLineRef = useRef(null);\n  const keyToIndexRecord = {};\n  let firstActiveKey = null;\n  const panes = [];\n  React.Children.forEach(props.children, (child, index) => {\n    if (!React.isValidElement(child)) return;\n    const key = child.key;\n    if (typeof key !== 'string') return;\n\n    if (index === 0) {\n      firstActiveKey = key;\n    }\n\n    const length = panes.push(child);\n    keyToIndexRecord[key] = length - 1;\n  });\n  const [activeKey, setActiveKey] = usePropsValue({\n    value: props.activeKey,\n    defaultValue: (_a = props.defaultActiveKey) !== null && _a !== void 0 ? _a : firstActiveKey,\n    onChange: v => {\n      var _a;\n\n      if (v === null) return;\n      (_a = props.onChange) === null || _a === void 0 ? void 0 : _a.call(props, v);\n    }\n  });\n  const [{\n    x,\n    width\n  }, api] = useSpring(() => ({\n    x: 0,\n    width: 0,\n    config: {\n      tension: 300,\n      clamp: true\n    }\n  }));\n  const [{\n    scrollLeft\n  }, scrollApi] = useSpring(() => ({\n    scrollLeft: 0,\n    config: {\n      tension: 300,\n      clamp: true\n    }\n  }));\n  const [{\n    leftMaskOpacity,\n    rightMaskOpacity\n  }, maskApi] = useSpring(() => ({\n    leftMaskOpacity: 0,\n    rightMaskOpacity: 0,\n    config: {\n      clamp: true\n    }\n  }));\n\n  function animate(immediate = false) {\n    const container = tabListContainerRef.current;\n    if (!container) return;\n    const activeIndex = keyToIndexRecord[activeKey];\n\n    if (activeIndex === undefined) {\n      api.start({\n        x: 0,\n        width: 0,\n        immediate: true\n      });\n      return;\n    }\n\n    const activeLine = activeLineRef.current;\n    if (!activeLine) return;\n    const activeTabWrapper = container.children.item(activeIndex + 1);\n    const activeTab = activeTabWrapper.children.item(0);\n    const activeTabLeft = activeTab.offsetLeft;\n    const activeTabWidth = activeTab.offsetWidth;\n    const activeTabWrapperLeft = activeTabWrapper.offsetLeft;\n    const activeTabWrapperWidth = activeTabWrapper.offsetWidth;\n    const containerWidth = container.offsetWidth;\n    const containerScrollWidth = container.scrollWidth;\n    const containerScrollLeft = container.scrollLeft;\n    const activeLineWidth = activeLine.offsetWidth;\n    let x = 0;\n    let width = 0;\n\n    if (props.activeLineMode === 'auto') {\n      x = activeTabLeft;\n      width = activeTabWidth;\n    } else if (props.activeLineMode === 'full') {\n      x = activeTabWrapperLeft;\n      width = activeTabWrapperWidth;\n    } else {\n      x = activeTabLeft + (activeTabWidth - activeLineWidth) / 2;\n    }\n\n    api.start({\n      x,\n      width,\n      immediate\n    });\n    const maxScrollDistance = containerScrollWidth - containerWidth;\n    if (maxScrollDistance <= 0) return;\n    const nextScrollLeft = bound(activeTabLeft - (containerWidth - activeTabWidth) / 2, 0, containerScrollWidth - containerWidth);\n    scrollApi.start({\n      scrollLeft: nextScrollLeft,\n      from: {\n        scrollLeft: containerScrollLeft\n      },\n      immediate\n    });\n  }\n\n  useIsomorphicLayoutEffect(() => {\n    animate(!x.isAnimating);\n  }, []);\n  useIsomorphicUpdateLayoutEffect(() => {\n    animate();\n  }, [activeKey]);\n  useResizeEffect(() => {\n    animate(!x.isAnimating);\n  }, tabListContainerRef);\n  useMutationEffect(() => {\n    animate(!x.isAnimating);\n  }, tabListContainerRef, {\n    subtree: true,\n    childList: true,\n    characterData: true\n  });\n  const {\n    run: updateMask\n  } = useThrottleFn((immediate = false) => {\n    const container = tabListContainerRef.current;\n    if (!container) return;\n    const scrollLeft = container.scrollLeft;\n    const showLeftMask = scrollLeft > 0;\n    const showRightMask = scrollLeft + container.offsetWidth < container.scrollWidth;\n    maskApi.start({\n      leftMaskOpacity: showLeftMask ? 1 : 0,\n      rightMaskOpacity: showRightMask ? 1 : 0,\n      immediate\n    });\n  }, {\n    wait: 100,\n    trailing: true,\n    leading: true\n  });\n  useIsomorphicLayoutEffect(() => {\n    updateMask(true);\n  }, []);\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classPrefix\n  }, React.createElement(\"div\", {\n    className: `${classPrefix}-header`\n  }, React.createElement(animated.div, {\n    className: classNames(`${classPrefix}-header-mask`, `${classPrefix}-header-mask-left`),\n    style: {\n      opacity: leftMaskOpacity\n    }\n  }), React.createElement(animated.div, {\n    className: classNames(`${classPrefix}-header-mask`, `${classPrefix}-header-mask-right`),\n    style: {\n      opacity: rightMaskOpacity\n    }\n  }), React.createElement(animated.div, {\n    className: `${classPrefix}-tab-list`,\n    ref: tabListContainerRef,\n    scrollLeft: scrollLeft,\n    onScroll: updateMask\n  }, React.createElement(animated.div, {\n    ref: activeLineRef,\n    className: `${classPrefix}-tab-line`,\n    style: {\n      width: props.activeLineMode === 'fixed' ? 'var(--fixed-active-line-width, 30px)' : width,\n      x\n    }\n  }), panes.map(pane => withNativeProps(pane.props, React.createElement(\"div\", {\n    key: pane.key,\n    className: classNames(`${classPrefix}-tab-wrapper`, {\n      [`${classPrefix}-tab-wrapper-stretch`]: props.stretch\n    })\n  }, React.createElement(\"div\", {\n    onClick: () => {\n      const {\n        key\n      } = pane;\n      if (pane.props.disabled) return;\n\n      if (key === undefined || key === null) {\n        return;\n      }\n\n      setActiveKey(key.toString());\n    },\n    className: classNames(`${classPrefix}-tab`, {\n      [`${classPrefix}-tab-active`]: pane.key === activeKey,\n      [`${classPrefix}-tab-disabled`]: pane.props.disabled\n    })\n  }, pane.props.title)))))), panes.map(pane => {\n    if (pane.props.children === undefined) {\n      return null;\n    }\n\n    const active = pane.key === activeKey;\n    return React.createElement(ShouldRender, {\n      key: pane.key,\n      active: active,\n      forceRender: pane.props.forceRender,\n      destroyOnClose: pane.props.destroyOnClose\n    }, React.createElement(\"div\", {\n      className: `${classPrefix}-content`,\n      style: {\n        display: active ? 'block' : 'none'\n      }\n    }, pane.props.children));\n  })));\n};"]},"metadata":{},"sourceType":"module"}