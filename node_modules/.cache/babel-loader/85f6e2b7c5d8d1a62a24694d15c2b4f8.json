{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nvar __spread = this && this.__spread || function () {\n  for (var ar = [], i = 0; i < arguments.length; i++) {\n    ar = ar.concat(__read(arguments[i]));\n  }\n\n  return ar;\n};\n\nimport useCreation from '../../useCreation';\nimport useLatest from '../../useLatest';\nimport useMemoizedFn from '../../useMemoizedFn';\nimport useMount from '../../useMount';\nimport useUnmount from '../../useUnmount';\nimport useUpdate from '../../useUpdate';\nimport Fetch from './Fetch';\n\nfunction useRequestImplement(service, options, plugins) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  if (plugins === void 0) {\n    plugins = [];\n  }\n\n  var _a = options.manual,\n      manual = _a === void 0 ? false : _a,\n      rest = __rest(options, [\"manual\"]);\n\n  var fetchOptions = __assign({\n    manual: manual\n  }, rest);\n\n  var serviceRef = useLatest(service);\n  var update = useUpdate();\n  var fetchInstance = useCreation(function () {\n    var initState = plugins.map(function (p) {\n      var _a;\n\n      return (_a = p === null || p === void 0 ? void 0 : p.onInit) === null || _a === void 0 ? void 0 : _a.call(p, fetchOptions);\n    }).filter(Boolean);\n    return new Fetch(serviceRef, fetchOptions, update, Object.assign.apply(Object, __spread([{}], initState)));\n  }, []);\n  fetchInstance.options = fetchOptions; // run all plugins hooks\n\n  fetchInstance.pluginImpls = plugins.map(function (p) {\n    return p(fetchInstance, fetchOptions);\n  });\n  useMount(function () {\n    if (!manual) {\n      // useCachePlugin can set fetchInstance.state.params from cache when init\n      var params = fetchInstance.state.params || options.defaultParams || []; // @ts-ignore\n\n      fetchInstance.run.apply(fetchInstance, __spread(params));\n    }\n  });\n  useUnmount(function () {\n    fetchInstance.cancel();\n  });\n  return {\n    loading: fetchInstance.state.loading,\n    data: fetchInstance.state.data,\n    error: fetchInstance.state.error,\n    params: fetchInstance.state.params || [],\n    cancel: useMemoizedFn(fetchInstance.cancel.bind(fetchInstance)),\n    refresh: useMemoizedFn(fetchInstance.refresh.bind(fetchInstance)),\n    refreshAsync: useMemoizedFn(fetchInstance.refreshAsync.bind(fetchInstance)),\n    run: useMemoizedFn(fetchInstance.run.bind(fetchInstance)),\n    runAsync: useMemoizedFn(fetchInstance.runAsync.bind(fetchInstance)),\n    mutate: useMemoizedFn(fetchInstance.mutate.bind(fetchInstance))\n  };\n}\n\nexport default useRequestImplement;","map":{"version":3,"sources":["D:/react/project0330/node_modules/ahooks/es/useRequest/src/useRequestImplement.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__read","o","m","Symbol","iterator","r","ar","next","done","push","value","error","__spread","concat","useCreation","useLatest","useMemoizedFn","useMount","useUnmount","useUpdate","Fetch","useRequestImplement","service","options","plugins","_a","manual","rest","fetchOptions","serviceRef","update","fetchInstance","initState","map","onInit","filter","Boolean","pluginImpls","params","state","defaultParams","run","cancel","loading","data","bind","refresh","refreshAsync","runAsync","mutate"],"mappings":"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","sourcesContent":["var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nvar __spread = this && this.__spread || function () {\n  for (var ar = [], i = 0; i < arguments.length; i++) {\n    ar = ar.concat(__read(arguments[i]));\n  }\n\n  return ar;\n};\n\nimport useCreation from '../../useCreation';\nimport useLatest from '../../useLatest';\nimport useMemoizedFn from '../../useMemoizedFn';\nimport useMount from '../../useMount';\nimport useUnmount from '../../useUnmount';\nimport useUpdate from '../../useUpdate';\nimport Fetch from './Fetch';\n\nfunction useRequestImplement(service, options, plugins) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  if (plugins === void 0) {\n    plugins = [];\n  }\n\n  var _a = options.manual,\n      manual = _a === void 0 ? false : _a,\n      rest = __rest(options, [\"manual\"]);\n\n  var fetchOptions = __assign({\n    manual: manual\n  }, rest);\n\n  var serviceRef = useLatest(service);\n  var update = useUpdate();\n  var fetchInstance = useCreation(function () {\n    var initState = plugins.map(function (p) {\n      var _a;\n\n      return (_a = p === null || p === void 0 ? void 0 : p.onInit) === null || _a === void 0 ? void 0 : _a.call(p, fetchOptions);\n    }).filter(Boolean);\n    return new Fetch(serviceRef, fetchOptions, update, Object.assign.apply(Object, __spread([{}], initState)));\n  }, []);\n  fetchInstance.options = fetchOptions; // run all plugins hooks\n\n  fetchInstance.pluginImpls = plugins.map(function (p) {\n    return p(fetchInstance, fetchOptions);\n  });\n  useMount(function () {\n    if (!manual) {\n      // useCachePlugin can set fetchInstance.state.params from cache when init\n      var params = fetchInstance.state.params || options.defaultParams || []; // @ts-ignore\n\n      fetchInstance.run.apply(fetchInstance, __spread(params));\n    }\n  });\n  useUnmount(function () {\n    fetchInstance.cancel();\n  });\n  return {\n    loading: fetchInstance.state.loading,\n    data: fetchInstance.state.data,\n    error: fetchInstance.state.error,\n    params: fetchInstance.state.params || [],\n    cancel: useMemoizedFn(fetchInstance.cancel.bind(fetchInstance)),\n    refresh: useMemoizedFn(fetchInstance.refresh.bind(fetchInstance)),\n    refreshAsync: useMemoizedFn(fetchInstance.refreshAsync.bind(fetchInstance)),\n    run: useMemoizedFn(fetchInstance.run.bind(fetchInstance)),\n    runAsync: useMemoizedFn(fetchInstance.runAsync.bind(fetchInstance)),\n    mutate: useMemoizedFn(fetchInstance.mutate.bind(fetchInstance))\n  };\n}\n\nexport default useRequestImplement;"]},"metadata":{},"sourceType":"module"}