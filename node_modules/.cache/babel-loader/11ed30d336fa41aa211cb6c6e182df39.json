{"ast":null,"code":"var __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nimport { useEffect, useRef, useState } from 'react'; // {[path]: count}\n// remove external when no used\n\nvar EXTERNAL_USED_COUNT = {};\n\nvar loadScript = function loadScript(path, props) {\n  if (props === void 0) {\n    props = {};\n  }\n\n  var script = document.querySelector(\"script[src=\\\"\" + path + \"\\\"]\");\n\n  if (!script) {\n    var newScript_1 = document.createElement('script');\n    newScript_1.src = path;\n    Object.keys(props).forEach(function (key) {\n      newScript_1[key] = props[key];\n    });\n    newScript_1.setAttribute('data-status', 'loading');\n    document.body.appendChild(newScript_1);\n    return {\n      ref: newScript_1,\n      status: 'loading'\n    };\n  }\n\n  return {\n    ref: script,\n    status: script.getAttribute('data-status') || 'ready'\n  };\n};\n\nvar loadCss = function loadCss(path, props) {\n  if (props === void 0) {\n    props = {};\n  }\n\n  var css = document.querySelector(\"link[href=\\\"\" + path + \"\\\"]\");\n\n  if (!css) {\n    var newCss_1 = document.createElement('link');\n    newCss_1.rel = 'stylesheet';\n    newCss_1.href = path;\n    Object.keys(props).forEach(function (key) {\n      newCss_1[key] = props[key];\n    }); // IE9+\n\n    var isLegacyIECss = ('hideFocus' in newCss_1); // use preload in IE Edge (to detect load errors)\n\n    if (isLegacyIECss && newCss_1.relList) {\n      newCss_1.rel = 'preload';\n      newCss_1.as = 'style';\n    }\n\n    newCss_1.setAttribute('data-status', 'loading');\n    document.head.appendChild(newCss_1);\n    return {\n      ref: newCss_1,\n      status: 'loading'\n    };\n  }\n\n  return {\n    ref: css,\n    status: css.getAttribute('data-status') || 'ready'\n  };\n};\n\nvar useExternal = function useExternal(path, options) {\n  var _a = __read(useState(path ? 'loading' : 'unset'), 2),\n      status = _a[0],\n      setStatus = _a[1];\n\n  var ref = useRef();\n  useEffect(function () {\n    if (!path) {\n      setStatus('unset');\n      return;\n    }\n\n    var pathname = path.replace(/[|#].*$/, '');\n\n    if ((options === null || options === void 0 ? void 0 : options.type) === 'css' || !(options === null || options === void 0 ? void 0 : options.type) && /(^css!|\\.css$)/.test(pathname)) {\n      var result = loadCss(path, options === null || options === void 0 ? void 0 : options.css);\n      ref.current = result.ref;\n      setStatus(result.status);\n    } else if ((options === null || options === void 0 ? void 0 : options.type) === 'js' || !(options === null || options === void 0 ? void 0 : options.type) && /(^js!|\\.js$)/.test(pathname)) {\n      var result = loadScript(path, options === null || options === void 0 ? void 0 : options.js);\n      ref.current = result.ref;\n      setStatus(result.status);\n    } else {\n      // do nothing\n      console.error(\"Cannot infer the type of external resource, and please provide a type ('js' | 'css'). \" + 'Refer to the https://ahooks.js.org/hooks/dom/use-external/#options');\n    }\n\n    if (!ref.current) {\n      return;\n    }\n\n    if (EXTERNAL_USED_COUNT[path] === undefined) {\n      EXTERNAL_USED_COUNT[path] = 1;\n    } else {\n      EXTERNAL_USED_COUNT[path] += 1;\n    }\n\n    var handler = function handler(event) {\n      var _a;\n\n      var targetStatus = event.type === 'load' ? 'ready' : 'error';\n      (_a = ref.current) === null || _a === void 0 ? void 0 : _a.setAttribute('data-status', targetStatus);\n      setStatus(targetStatus);\n    };\n\n    ref.current.addEventListener('load', handler);\n    ref.current.addEventListener('error', handler);\n    return function () {\n      var _a, _b, _c;\n\n      (_a = ref.current) === null || _a === void 0 ? void 0 : _a.removeEventListener('load', handler);\n      (_b = ref.current) === null || _b === void 0 ? void 0 : _b.removeEventListener('error', handler);\n      EXTERNAL_USED_COUNT[path] -= 1;\n\n      if (EXTERNAL_USED_COUNT[path] === 0) {\n        (_c = ref.current) === null || _c === void 0 ? void 0 : _c.remove();\n      }\n\n      ref.current = undefined;\n    };\n  }, [path]);\n  return status;\n};\n\nexport default useExternal;","map":{"version":3,"sources":["D:/react/project0330/node_modules/ahooks/es/useExternal/index.js"],"names":["__read","o","n","m","Symbol","iterator","i","call","r","ar","e","next","done","push","value","error","useEffect","useRef","useState","EXTERNAL_USED_COUNT","loadScript","path","props","script","document","querySelector","newScript_1","createElement","src","Object","keys","forEach","key","setAttribute","body","appendChild","ref","status","getAttribute","loadCss","css","newCss_1","rel","href","isLegacyIECss","relList","as","head","useExternal","options","_a","setStatus","pathname","replace","type","test","result","current","js","console","undefined","handler","event","targetStatus","addEventListener","_b","_c","removeEventListener","remove"],"mappings":"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","sourcesContent":["var __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nimport { useEffect, useRef, useState } from 'react'; // {[path]: count}\n// remove external when no used\n\nvar EXTERNAL_USED_COUNT = {};\n\nvar loadScript = function loadScript(path, props) {\n  if (props === void 0) {\n    props = {};\n  }\n\n  var script = document.querySelector(\"script[src=\\\"\" + path + \"\\\"]\");\n\n  if (!script) {\n    var newScript_1 = document.createElement('script');\n    newScript_1.src = path;\n    Object.keys(props).forEach(function (key) {\n      newScript_1[key] = props[key];\n    });\n    newScript_1.setAttribute('data-status', 'loading');\n    document.body.appendChild(newScript_1);\n    return {\n      ref: newScript_1,\n      status: 'loading'\n    };\n  }\n\n  return {\n    ref: script,\n    status: script.getAttribute('data-status') || 'ready'\n  };\n};\n\nvar loadCss = function loadCss(path, props) {\n  if (props === void 0) {\n    props = {};\n  }\n\n  var css = document.querySelector(\"link[href=\\\"\" + path + \"\\\"]\");\n\n  if (!css) {\n    var newCss_1 = document.createElement('link');\n    newCss_1.rel = 'stylesheet';\n    newCss_1.href = path;\n    Object.keys(props).forEach(function (key) {\n      newCss_1[key] = props[key];\n    }); // IE9+\n\n    var isLegacyIECss = ('hideFocus' in newCss_1); // use preload in IE Edge (to detect load errors)\n\n    if (isLegacyIECss && newCss_1.relList) {\n      newCss_1.rel = 'preload';\n      newCss_1.as = 'style';\n    }\n\n    newCss_1.setAttribute('data-status', 'loading');\n    document.head.appendChild(newCss_1);\n    return {\n      ref: newCss_1,\n      status: 'loading'\n    };\n  }\n\n  return {\n    ref: css,\n    status: css.getAttribute('data-status') || 'ready'\n  };\n};\n\nvar useExternal = function useExternal(path, options) {\n  var _a = __read(useState(path ? 'loading' : 'unset'), 2),\n      status = _a[0],\n      setStatus = _a[1];\n\n  var ref = useRef();\n  useEffect(function () {\n    if (!path) {\n      setStatus('unset');\n      return;\n    }\n\n    var pathname = path.replace(/[|#].*$/, '');\n\n    if ((options === null || options === void 0 ? void 0 : options.type) === 'css' || !(options === null || options === void 0 ? void 0 : options.type) && /(^css!|\\.css$)/.test(pathname)) {\n      var result = loadCss(path, options === null || options === void 0 ? void 0 : options.css);\n      ref.current = result.ref;\n      setStatus(result.status);\n    } else if ((options === null || options === void 0 ? void 0 : options.type) === 'js' || !(options === null || options === void 0 ? void 0 : options.type) && /(^js!|\\.js$)/.test(pathname)) {\n      var result = loadScript(path, options === null || options === void 0 ? void 0 : options.js);\n      ref.current = result.ref;\n      setStatus(result.status);\n    } else {\n      // do nothing\n      console.error(\"Cannot infer the type of external resource, and please provide a type ('js' | 'css'). \" + 'Refer to the https://ahooks.js.org/hooks/dom/use-external/#options');\n    }\n\n    if (!ref.current) {\n      return;\n    }\n\n    if (EXTERNAL_USED_COUNT[path] === undefined) {\n      EXTERNAL_USED_COUNT[path] = 1;\n    } else {\n      EXTERNAL_USED_COUNT[path] += 1;\n    }\n\n    var handler = function handler(event) {\n      var _a;\n\n      var targetStatus = event.type === 'load' ? 'ready' : 'error';\n      (_a = ref.current) === null || _a === void 0 ? void 0 : _a.setAttribute('data-status', targetStatus);\n      setStatus(targetStatus);\n    };\n\n    ref.current.addEventListener('load', handler);\n    ref.current.addEventListener('error', handler);\n    return function () {\n      var _a, _b, _c;\n\n      (_a = ref.current) === null || _a === void 0 ? void 0 : _a.removeEventListener('load', handler);\n      (_b = ref.current) === null || _b === void 0 ? void 0 : _b.removeEventListener('error', handler);\n      EXTERNAL_USED_COUNT[path] -= 1;\n\n      if (EXTERNAL_USED_COUNT[path] === 0) {\n        (_c = ref.current) === null || _c === void 0 ? void 0 : _c.remove();\n      }\n\n      ref.current = undefined;\n    };\n  }, [path]);\n  return status;\n};\n\nexport default useExternal;"]},"metadata":{},"sourceType":"module"}