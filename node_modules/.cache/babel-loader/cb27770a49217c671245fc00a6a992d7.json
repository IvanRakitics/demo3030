{"ast":null,"code":"import React, { useState, useEffect, memo } from 'react';\nimport Popup from '../popup';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { withNativeProps } from '../../utils/native-props';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport PickerView from '../picker-view';\nimport { generateColumnsExtend, useColumnsExtend } from '../picker-view/columns-extend';\nimport { useConfig } from '../config-provider';\nimport { useMemoizedFn } from 'ahooks';\nimport SafeArea from '../safe-area';\nimport { defaultRenderLabel } from './picker-utils';\nconst classPrefix = `adm-picker`;\nconst defaultProps = {\n  defaultValue: [],\n  closeOnMaskClick: true,\n  renderLabel: defaultRenderLabel\n};\nexport const Picker = memo(p => {\n  var _a;\n\n  const {\n    locale\n  } = useConfig();\n  const props = mergeProps(defaultProps, {\n    confirmText: locale.common.confirm,\n    cancelText: locale.common.cancel\n  }, p);\n  const [value, setValue] = usePropsValue(Object.assign(Object.assign({}, props), {\n    onChange: val => {\n      var _a;\n\n      const extend = generateColumnsExtend(props.columns, val);\n      (_a = props.onConfirm) === null || _a === void 0 ? void 0 : _a.call(props, val, extend);\n    }\n  }));\n  const extend = useColumnsExtend(props.columns, value);\n  const [innerValue, setInnerValue] = useState(value);\n  useEffect(() => {\n    if (innerValue !== value) {\n      setInnerValue(value);\n    }\n  }, [props.visible]);\n  useEffect(() => {\n    if (!props.visible) {\n      setInnerValue(value);\n    }\n  }, [value]);\n  const onChange = useMemoizedFn((val, ext) => {\n    var _a;\n\n    setInnerValue(val);\n\n    if (props.visible) {\n      (_a = props.onSelect) === null || _a === void 0 ? void 0 : _a.call(props, val, ext);\n    }\n  });\n  const pickerElement = withNativeProps(props, React.createElement(\"div\", {\n    className: classPrefix\n  }, React.createElement(\"div\", {\n    className: `${classPrefix}-header`\n  }, React.createElement(\"a\", {\n    className: `${classPrefix}-header-button`,\n    onClick: () => {\n      var _a, _b;\n\n      (_a = props.onCancel) === null || _a === void 0 ? void 0 : _a.call(props);\n      (_b = props.onClose) === null || _b === void 0 ? void 0 : _b.call(props);\n    }\n  }, props.cancelText), React.createElement(\"div\", {\n    className: `${classPrefix}-header-title`\n  }, props.title), React.createElement(\"a\", {\n    className: `${classPrefix}-header-button`,\n    onClick: () => {\n      var _a;\n\n      setValue(innerValue);\n      (_a = props.onClose) === null || _a === void 0 ? void 0 : _a.call(props);\n    }\n  }, props.confirmText)), React.createElement(\"div\", {\n    className: `${classPrefix}-body`\n  }, React.createElement(PickerView, {\n    columns: props.columns,\n    renderLabel: props.renderLabel,\n    value: innerValue,\n    onChange: onChange\n  }))));\n  const popupElement = React.createElement(Popup, {\n    className: `${classPrefix}-popup`,\n    visible: props.visible,\n    position: 'bottom',\n    onMaskClick: () => {\n      var _a, _b;\n\n      if (!props.closeOnMaskClick) return;\n      (_a = props.onCancel) === null || _a === void 0 ? void 0 : _a.call(props);\n      (_b = props.onClose) === null || _b === void 0 ? void 0 : _b.call(props);\n    },\n    getContainer: props.getContainer,\n    destroyOnClose: true,\n    afterShow: props.afterShow,\n    afterClose: props.afterClose,\n    onClick: props.onClick,\n    forceRender: true,\n    stopPropagation: props.stopPropagation\n  }, pickerElement, React.createElement(SafeArea, {\n    position: 'bottom'\n  }));\n  return React.createElement(React.Fragment, null, popupElement, (_a = props.children) === null || _a === void 0 ? void 0 : _a.call(props, extend.items));\n});\nPicker.displayName = 'Picker';","map":{"version":3,"sources":["D:/react/project0330/node_modules/antd-mobile/es/components/picker/picker.js"],"names":["React","useState","useEffect","memo","Popup","mergeProps","withNativeProps","usePropsValue","PickerView","generateColumnsExtend","useColumnsExtend","useConfig","useMemoizedFn","SafeArea","defaultRenderLabel","classPrefix","defaultProps","defaultValue","closeOnMaskClick","renderLabel","Picker","p","_a","locale","props","confirmText","common","confirm","cancelText","cancel","value","setValue","Object","assign","onChange","val","extend","columns","onConfirm","call","innerValue","setInnerValue","visible","ext","onSelect","pickerElement","createElement","className","onClick","_b","onCancel","onClose","title","popupElement","position","onMaskClick","getContainer","destroyOnClose","afterShow","afterClose","forceRender","stopPropagation","Fragment","children","items","displayName"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, memo } from 'react';\nimport Popup from '../popup';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { withNativeProps } from '../../utils/native-props';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport PickerView from '../picker-view';\nimport { generateColumnsExtend, useColumnsExtend } from '../picker-view/columns-extend';\nimport { useConfig } from '../config-provider';\nimport { useMemoizedFn } from 'ahooks';\nimport SafeArea from '../safe-area';\nimport { defaultRenderLabel } from './picker-utils';\nconst classPrefix = `adm-picker`;\nconst defaultProps = {\n  defaultValue: [],\n  closeOnMaskClick: true,\n  renderLabel: defaultRenderLabel\n};\nexport const Picker = memo(p => {\n  var _a;\n\n  const {\n    locale\n  } = useConfig();\n  const props = mergeProps(defaultProps, {\n    confirmText: locale.common.confirm,\n    cancelText: locale.common.cancel\n  }, p);\n  const [value, setValue] = usePropsValue(Object.assign(Object.assign({}, props), {\n    onChange: val => {\n      var _a;\n\n      const extend = generateColumnsExtend(props.columns, val);\n      (_a = props.onConfirm) === null || _a === void 0 ? void 0 : _a.call(props, val, extend);\n    }\n  }));\n  const extend = useColumnsExtend(props.columns, value);\n  const [innerValue, setInnerValue] = useState(value);\n  useEffect(() => {\n    if (innerValue !== value) {\n      setInnerValue(value);\n    }\n  }, [props.visible]);\n  useEffect(() => {\n    if (!props.visible) {\n      setInnerValue(value);\n    }\n  }, [value]);\n  const onChange = useMemoizedFn((val, ext) => {\n    var _a;\n\n    setInnerValue(val);\n\n    if (props.visible) {\n      (_a = props.onSelect) === null || _a === void 0 ? void 0 : _a.call(props, val, ext);\n    }\n  });\n  const pickerElement = withNativeProps(props, React.createElement(\"div\", {\n    className: classPrefix\n  }, React.createElement(\"div\", {\n    className: `${classPrefix}-header`\n  }, React.createElement(\"a\", {\n    className: `${classPrefix}-header-button`,\n    onClick: () => {\n      var _a, _b;\n\n      (_a = props.onCancel) === null || _a === void 0 ? void 0 : _a.call(props);\n      (_b = props.onClose) === null || _b === void 0 ? void 0 : _b.call(props);\n    }\n  }, props.cancelText), React.createElement(\"div\", {\n    className: `${classPrefix}-header-title`\n  }, props.title), React.createElement(\"a\", {\n    className: `${classPrefix}-header-button`,\n    onClick: () => {\n      var _a;\n\n      setValue(innerValue);\n      (_a = props.onClose) === null || _a === void 0 ? void 0 : _a.call(props);\n    }\n  }, props.confirmText)), React.createElement(\"div\", {\n    className: `${classPrefix}-body`\n  }, React.createElement(PickerView, {\n    columns: props.columns,\n    renderLabel: props.renderLabel,\n    value: innerValue,\n    onChange: onChange\n  }))));\n  const popupElement = React.createElement(Popup, {\n    className: `${classPrefix}-popup`,\n    visible: props.visible,\n    position: 'bottom',\n    onMaskClick: () => {\n      var _a, _b;\n\n      if (!props.closeOnMaskClick) return;\n      (_a = props.onCancel) === null || _a === void 0 ? void 0 : _a.call(props);\n      (_b = props.onClose) === null || _b === void 0 ? void 0 : _b.call(props);\n    },\n    getContainer: props.getContainer,\n    destroyOnClose: true,\n    afterShow: props.afterShow,\n    afterClose: props.afterClose,\n    onClick: props.onClick,\n    forceRender: true,\n    stopPropagation: props.stopPropagation\n  }, pickerElement, React.createElement(SafeArea, {\n    position: 'bottom'\n  }));\n  return React.createElement(React.Fragment, null, popupElement, (_a = props.children) === null || _a === void 0 ? void 0 : _a.call(props, extend.items));\n});\nPicker.displayName = 'Picker';"]},"metadata":{},"sourceType":"module"}