{"ast":null,"code":"import { useRef } from 'react';\nimport useLatest from '../useLatest';\nimport { getTargetElement } from '../utils/domTarget';\nimport isBrowser from '../utils/isBrowser';\nimport useEffectWithTarget from '../utils/useEffectWithTarget';\nvar touchSupported = isBrowser && ( // @ts-ignore\n'ontouchstart' in window || window.DocumentTouch && document instanceof DocumentTouch);\n\nfunction useLongPress(onLongPress, target, _a) {\n  var _b = _a === void 0 ? {} : _a,\n      _c = _b.delay,\n      delay = _c === void 0 ? 300 : _c,\n      onClick = _b.onClick,\n      onLongPressEnd = _b.onLongPressEnd;\n\n  var onLongPressRef = useLatest(onLongPress);\n  var onClickRef = useLatest(onClick);\n  var onLongPressEndRef = useLatest(onLongPressEnd);\n  var timerRef = useRef();\n  var isTriggeredRef = useRef(false);\n  useEffectWithTarget(function () {\n    var targetElement = getTargetElement(target);\n\n    if (!(targetElement === null || targetElement === void 0 ? void 0 : targetElement.addEventListener)) {\n      return;\n    }\n\n    var onStart = function onStart(event) {\n      timerRef.current = setTimeout(function () {\n        onLongPressRef.current(event);\n        isTriggeredRef.current = true;\n      }, delay);\n    };\n\n    var onEnd = function onEnd(event, shouldTriggerClick) {\n      var _a;\n\n      if (shouldTriggerClick === void 0) {\n        shouldTriggerClick = false;\n      }\n\n      if (timerRef.current) {\n        clearTimeout(timerRef.current);\n      }\n\n      if (isTriggeredRef.current) {\n        (_a = onLongPressEndRef.current) === null || _a === void 0 ? void 0 : _a.call(onLongPressEndRef, event);\n      }\n\n      if (shouldTriggerClick && !isTriggeredRef.current && onClickRef.current) {\n        onClickRef.current(event);\n      }\n\n      isTriggeredRef.current = false;\n    };\n\n    var onEndWithClick = function onEndWithClick(event) {\n      return onEnd(event, true);\n    };\n\n    if (!touchSupported) {\n      targetElement.addEventListener('mousedown', onStart);\n      targetElement.addEventListener('mouseup', onEndWithClick);\n      targetElement.addEventListener('mouseleave', onEnd);\n    } else {\n      targetElement.addEventListener('touchstart', onStart);\n      targetElement.addEventListener('touchend', onEndWithClick);\n    }\n\n    return function () {\n      if (timerRef.current) {\n        clearTimeout(timerRef.current);\n        isTriggeredRef.current = false;\n      }\n\n      if (!touchSupported) {\n        targetElement.removeEventListener('mousedown', onStart);\n        targetElement.removeEventListener('mouseup', onEndWithClick);\n        targetElement.removeEventListener('mouseleave', onEnd);\n      } else {\n        targetElement.removeEventListener('touchstart', onStart);\n        targetElement.removeEventListener('touchend', onEndWithClick);\n      }\n    };\n  }, [], target);\n}\n\nexport default useLongPress;","map":{"version":3,"sources":["D:/react/project0330/node_modules/ahooks/es/useLongPress/index.js"],"names":["useRef","useLatest","getTargetElement","isBrowser","useEffectWithTarget","touchSupported","window","DocumentTouch","document","useLongPress","onLongPress","target","_a","_b","_c","delay","onClick","onLongPressEnd","onLongPressRef","onClickRef","onLongPressEndRef","timerRef","isTriggeredRef","targetElement","addEventListener","onStart","event","current","setTimeout","onEnd","shouldTriggerClick","clearTimeout","call","onEndWithClick","removeEventListener"],"mappings":"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","sourcesContent":["import { useRef } from 'react';\nimport useLatest from '../useLatest';\nimport { getTargetElement } from '../utils/domTarget';\nimport isBrowser from '../utils/isBrowser';\nimport useEffectWithTarget from '../utils/useEffectWithTarget';\nvar touchSupported = isBrowser && ( // @ts-ignore\n'ontouchstart' in window || window.DocumentTouch && document instanceof DocumentTouch);\n\nfunction useLongPress(onLongPress, target, _a) {\n  var _b = _a === void 0 ? {} : _a,\n      _c = _b.delay,\n      delay = _c === void 0 ? 300 : _c,\n      onClick = _b.onClick,\n      onLongPressEnd = _b.onLongPressEnd;\n\n  var onLongPressRef = useLatest(onLongPress);\n  var onClickRef = useLatest(onClick);\n  var onLongPressEndRef = useLatest(onLongPressEnd);\n  var timerRef = useRef();\n  var isTriggeredRef = useRef(false);\n  useEffectWithTarget(function () {\n    var targetElement = getTargetElement(target);\n\n    if (!(targetElement === null || targetElement === void 0 ? void 0 : targetElement.addEventListener)) {\n      return;\n    }\n\n    var onStart = function onStart(event) {\n      timerRef.current = setTimeout(function () {\n        onLongPressRef.current(event);\n        isTriggeredRef.current = true;\n      }, delay);\n    };\n\n    var onEnd = function onEnd(event, shouldTriggerClick) {\n      var _a;\n\n      if (shouldTriggerClick === void 0) {\n        shouldTriggerClick = false;\n      }\n\n      if (timerRef.current) {\n        clearTimeout(timerRef.current);\n      }\n\n      if (isTriggeredRef.current) {\n        (_a = onLongPressEndRef.current) === null || _a === void 0 ? void 0 : _a.call(onLongPressEndRef, event);\n      }\n\n      if (shouldTriggerClick && !isTriggeredRef.current && onClickRef.current) {\n        onClickRef.current(event);\n      }\n\n      isTriggeredRef.current = false;\n    };\n\n    var onEndWithClick = function onEndWithClick(event) {\n      return onEnd(event, true);\n    };\n\n    if (!touchSupported) {\n      targetElement.addEventListener('mousedown', onStart);\n      targetElement.addEventListener('mouseup', onEndWithClick);\n      targetElement.addEventListener('mouseleave', onEnd);\n    } else {\n      targetElement.addEventListener('touchstart', onStart);\n      targetElement.addEventListener('touchend', onEndWithClick);\n    }\n\n    return function () {\n      if (timerRef.current) {\n        clearTimeout(timerRef.current);\n        isTriggeredRef.current = false;\n      }\n\n      if (!touchSupported) {\n        targetElement.removeEventListener('mousedown', onStart);\n        targetElement.removeEventListener('mouseup', onEndWithClick);\n        targetElement.removeEventListener('mouseleave', onEnd);\n      } else {\n        targetElement.removeEventListener('touchstart', onStart);\n        targetElement.removeEventListener('touchend', onEndWithClick);\n      }\n    };\n  }, [], target);\n}\n\nexport default useLongPress;"]},"metadata":{},"sourceType":"module"}