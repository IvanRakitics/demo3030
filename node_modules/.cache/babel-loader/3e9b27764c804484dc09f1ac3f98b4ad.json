{"ast":null,"code":"import useLatest from '../useLatest';\nimport { getTargetElement } from '../utils/domTarget';\nimport useEffectWithTarget from '../utils/useEffectWithTarget';\nimport { useRef } from 'react';\n\nvar useDrop = function useDrop(target, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var optionsRef = useLatest(options); // https://stackoverflow.com/a/26459269\n\n  var dragEnterTarget = useRef();\n  useEffectWithTarget(function () {\n    var targetElement = getTargetElement(target);\n\n    if (!(targetElement === null || targetElement === void 0 ? void 0 : targetElement.addEventListener)) {\n      return;\n    }\n\n    var onData = function onData(dataTransfer, event) {\n      var uri = dataTransfer.getData('text/uri-list');\n      var dom = dataTransfer.getData('custom');\n\n      if (dom && optionsRef.current.onDom) {\n        var data = dom;\n\n        try {\n          data = JSON.parse(dom);\n        } catch (e) {\n          data = dom;\n        }\n\n        optionsRef.current.onDom(data, event);\n        return;\n      }\n\n      if (uri && optionsRef.current.onUri) {\n        optionsRef.current.onUri(uri, event);\n        return;\n      }\n\n      if (dataTransfer.files && dataTransfer.files.length && optionsRef.current.onFiles) {\n        optionsRef.current.onFiles(Array.from(dataTransfer.files), event);\n        return;\n      }\n\n      if (dataTransfer.items && dataTransfer.items.length && optionsRef.current.onText) {\n        dataTransfer.items[0].getAsString(function (text) {\n          optionsRef.current.onText(text, event);\n        });\n      }\n    };\n\n    var onDragEnter = function onDragEnter(event) {\n      var _a, _b;\n\n      event.preventDefault();\n      event.stopPropagation();\n      dragEnterTarget.current = event.target;\n      (_b = (_a = optionsRef.current).onDragEnter) === null || _b === void 0 ? void 0 : _b.call(_a, event);\n    };\n\n    var onDragOver = function onDragOver(event) {\n      var _a, _b;\n\n      event.preventDefault();\n      (_b = (_a = optionsRef.current).onDragOver) === null || _b === void 0 ? void 0 : _b.call(_a, event);\n    };\n\n    var onDragLeave = function onDragLeave(event) {\n      var _a, _b;\n\n      if (event.target === dragEnterTarget.current) {\n        (_b = (_a = optionsRef.current).onDragLeave) === null || _b === void 0 ? void 0 : _b.call(_a, event);\n      }\n    };\n\n    var onDrop = function onDrop(event) {\n      var _a, _b;\n\n      event.preventDefault();\n      onData(event.dataTransfer, event);\n      (_b = (_a = optionsRef.current).onDrop) === null || _b === void 0 ? void 0 : _b.call(_a, event);\n    };\n\n    var onPaste = function onPaste(event) {\n      var _a, _b;\n\n      onData(event.clipboardData, event);\n      (_b = (_a = optionsRef.current).onPaste) === null || _b === void 0 ? void 0 : _b.call(_a, event);\n    };\n\n    targetElement.addEventListener('dragenter', onDragEnter);\n    targetElement.addEventListener('dragover', onDragOver);\n    targetElement.addEventListener('dragleave', onDragLeave);\n    targetElement.addEventListener('drop', onDrop);\n    targetElement.addEventListener('paste', onPaste);\n    return function () {\n      targetElement.removeEventListener('dragenter', onDragEnter);\n      targetElement.removeEventListener('dragover', onDragOver);\n      targetElement.removeEventListener('dragleave', onDragLeave);\n      targetElement.removeEventListener('drop', onDrop);\n      targetElement.removeEventListener('paste', onPaste);\n    };\n  }, [], target);\n};\n\nexport default useDrop;","map":{"version":3,"sources":["D:/react/project0330/node_modules/ahooks/es/useDrop/index.js"],"names":["useLatest","getTargetElement","useEffectWithTarget","useRef","useDrop","target","options","optionsRef","dragEnterTarget","targetElement","addEventListener","onData","dataTransfer","event","uri","getData","dom","current","onDom","data","JSON","parse","e","onUri","files","length","onFiles","Array","from","items","onText","getAsString","text","onDragEnter","_a","_b","preventDefault","stopPropagation","call","onDragOver","onDragLeave","onDrop","onPaste","clipboardData","removeEventListener"],"mappings":"AAAA,OAAOA,SAAP,MAAsB,cAAtB;AACA,SAASC,gBAAT,QAAiC,oBAAjC;AACA,OAAOC,mBAAP,MAAgC,8BAAhC;AACA,SAASC,MAAT,QAAuB,OAAvB;;AAEA,IAAIC,OAAO,GAAG,SAASA,OAAT,CAAiBC,MAAjB,EAAyBC,OAAzB,EAAkC;AAC9C,MAAIA,OAAO,KAAK,KAAK,CAArB,EAAwB;AACtBA,IAAAA,OAAO,GAAG,EAAV;AACD;;AAED,MAAIC,UAAU,GAAGP,SAAS,CAACM,OAAD,CAA1B,CAL8C,CAKT;;AAErC,MAAIE,eAAe,GAAGL,MAAM,EAA5B;AACAD,EAAAA,mBAAmB,CAAC,YAAY;AAC9B,QAAIO,aAAa,GAAGR,gBAAgB,CAACI,MAAD,CAApC;;AAEA,QAAI,EAAEI,aAAa,KAAK,IAAlB,IAA0BA,aAAa,KAAK,KAAK,CAAjD,GAAqD,KAAK,CAA1D,GAA8DA,aAAa,CAACC,gBAA9E,CAAJ,EAAqG;AACnG;AACD;;AAED,QAAIC,MAAM,GAAG,SAASA,MAAT,CAAgBC,YAAhB,EAA8BC,KAA9B,EAAqC;AAChD,UAAIC,GAAG,GAAGF,YAAY,CAACG,OAAb,CAAqB,eAArB,CAAV;AACA,UAAIC,GAAG,GAAGJ,YAAY,CAACG,OAAb,CAAqB,QAArB,CAAV;;AAEA,UAAIC,GAAG,IAAIT,UAAU,CAACU,OAAX,CAAmBC,KAA9B,EAAqC;AACnC,YAAIC,IAAI,GAAGH,GAAX;;AAEA,YAAI;AACFG,UAAAA,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAWL,GAAX,CAAP;AACD,SAFD,CAEE,OAAOM,CAAP,EAAU;AACVH,UAAAA,IAAI,GAAGH,GAAP;AACD;;AAEDT,QAAAA,UAAU,CAACU,OAAX,CAAmBC,KAAnB,CAAyBC,IAAzB,EAA+BN,KAA/B;AACA;AACD;;AAED,UAAIC,GAAG,IAAIP,UAAU,CAACU,OAAX,CAAmBM,KAA9B,EAAqC;AACnChB,QAAAA,UAAU,CAACU,OAAX,CAAmBM,KAAnB,CAAyBT,GAAzB,EAA8BD,KAA9B;AACA;AACD;;AAED,UAAID,YAAY,CAACY,KAAb,IAAsBZ,YAAY,CAACY,KAAb,CAAmBC,MAAzC,IAAmDlB,UAAU,CAACU,OAAX,CAAmBS,OAA1E,EAAmF;AACjFnB,QAAAA,UAAU,CAACU,OAAX,CAAmBS,OAAnB,CAA2BC,KAAK,CAACC,IAAN,CAAWhB,YAAY,CAACY,KAAxB,CAA3B,EAA2DX,KAA3D;AACA;AACD;;AAED,UAAID,YAAY,CAACiB,KAAb,IAAsBjB,YAAY,CAACiB,KAAb,CAAmBJ,MAAzC,IAAmDlB,UAAU,CAACU,OAAX,CAAmBa,MAA1E,EAAkF;AAChFlB,QAAAA,YAAY,CAACiB,KAAb,CAAmB,CAAnB,EAAsBE,WAAtB,CAAkC,UAAUC,IAAV,EAAgB;AAChDzB,UAAAA,UAAU,CAACU,OAAX,CAAmBa,MAAnB,CAA0BE,IAA1B,EAAgCnB,KAAhC;AACD,SAFD;AAGD;AACF,KAhCD;;AAkCA,QAAIoB,WAAW,GAAG,SAASA,WAAT,CAAqBpB,KAArB,EAA4B;AAC5C,UAAIqB,EAAJ,EAAQC,EAAR;;AAEAtB,MAAAA,KAAK,CAACuB,cAAN;AACAvB,MAAAA,KAAK,CAACwB,eAAN;AACA7B,MAAAA,eAAe,CAACS,OAAhB,GAA0BJ,KAAK,CAACR,MAAhC;AACA,OAAC8B,EAAE,GAAG,CAACD,EAAE,GAAG3B,UAAU,CAACU,OAAjB,EAA0BgB,WAAhC,MAAiD,IAAjD,IAAyDE,EAAE,KAAK,KAAK,CAArE,GAAyE,KAAK,CAA9E,GAAkFA,EAAE,CAACG,IAAH,CAAQJ,EAAR,EAAYrB,KAAZ,CAAlF;AACD,KAPD;;AASA,QAAI0B,UAAU,GAAG,SAASA,UAAT,CAAoB1B,KAApB,EAA2B;AAC1C,UAAIqB,EAAJ,EAAQC,EAAR;;AAEAtB,MAAAA,KAAK,CAACuB,cAAN;AACA,OAACD,EAAE,GAAG,CAACD,EAAE,GAAG3B,UAAU,CAACU,OAAjB,EAA0BsB,UAAhC,MAAgD,IAAhD,IAAwDJ,EAAE,KAAK,KAAK,CAApE,GAAwE,KAAK,CAA7E,GAAiFA,EAAE,CAACG,IAAH,CAAQJ,EAAR,EAAYrB,KAAZ,CAAjF;AACD,KALD;;AAOA,QAAI2B,WAAW,GAAG,SAASA,WAAT,CAAqB3B,KAArB,EAA4B;AAC5C,UAAIqB,EAAJ,EAAQC,EAAR;;AAEA,UAAItB,KAAK,CAACR,MAAN,KAAiBG,eAAe,CAACS,OAArC,EAA8C;AAC5C,SAACkB,EAAE,GAAG,CAACD,EAAE,GAAG3B,UAAU,CAACU,OAAjB,EAA0BuB,WAAhC,MAAiD,IAAjD,IAAyDL,EAAE,KAAK,KAAK,CAArE,GAAyE,KAAK,CAA9E,GAAkFA,EAAE,CAACG,IAAH,CAAQJ,EAAR,EAAYrB,KAAZ,CAAlF;AACD;AACF,KAND;;AAQA,QAAI4B,MAAM,GAAG,SAASA,MAAT,CAAgB5B,KAAhB,EAAuB;AAClC,UAAIqB,EAAJ,EAAQC,EAAR;;AAEAtB,MAAAA,KAAK,CAACuB,cAAN;AACAzB,MAAAA,MAAM,CAACE,KAAK,CAACD,YAAP,EAAqBC,KAArB,CAAN;AACA,OAACsB,EAAE,GAAG,CAACD,EAAE,GAAG3B,UAAU,CAACU,OAAjB,EAA0BwB,MAAhC,MAA4C,IAA5C,IAAoDN,EAAE,KAAK,KAAK,CAAhE,GAAoE,KAAK,CAAzE,GAA6EA,EAAE,CAACG,IAAH,CAAQJ,EAAR,EAAYrB,KAAZ,CAA7E;AACD,KAND;;AAQA,QAAI6B,OAAO,GAAG,SAASA,OAAT,CAAiB7B,KAAjB,EAAwB;AACpC,UAAIqB,EAAJ,EAAQC,EAAR;;AAEAxB,MAAAA,MAAM,CAACE,KAAK,CAAC8B,aAAP,EAAsB9B,KAAtB,CAAN;AACA,OAACsB,EAAE,GAAG,CAACD,EAAE,GAAG3B,UAAU,CAACU,OAAjB,EAA0ByB,OAAhC,MAA6C,IAA7C,IAAqDP,EAAE,KAAK,KAAK,CAAjE,GAAqE,KAAK,CAA1E,GAA8EA,EAAE,CAACG,IAAH,CAAQJ,EAAR,EAAYrB,KAAZ,CAA9E;AACD,KALD;;AAOAJ,IAAAA,aAAa,CAACC,gBAAd,CAA+B,WAA/B,EAA4CuB,WAA5C;AACAxB,IAAAA,aAAa,CAACC,gBAAd,CAA+B,UAA/B,EAA2C6B,UAA3C;AACA9B,IAAAA,aAAa,CAACC,gBAAd,CAA+B,WAA/B,EAA4C8B,WAA5C;AACA/B,IAAAA,aAAa,CAACC,gBAAd,CAA+B,MAA/B,EAAuC+B,MAAvC;AACAhC,IAAAA,aAAa,CAACC,gBAAd,CAA+B,OAA/B,EAAwCgC,OAAxC;AACA,WAAO,YAAY;AACjBjC,MAAAA,aAAa,CAACmC,mBAAd,CAAkC,WAAlC,EAA+CX,WAA/C;AACAxB,MAAAA,aAAa,CAACmC,mBAAd,CAAkC,UAAlC,EAA8CL,UAA9C;AACA9B,MAAAA,aAAa,CAACmC,mBAAd,CAAkC,WAAlC,EAA+CJ,WAA/C;AACA/B,MAAAA,aAAa,CAACmC,mBAAd,CAAkC,MAAlC,EAA0CH,MAA1C;AACAhC,MAAAA,aAAa,CAACmC,mBAAd,CAAkC,OAAlC,EAA2CF,OAA3C;AACD,KAND;AAOD,GA5FkB,EA4FhB,EA5FgB,EA4FZrC,MA5FY,CAAnB;AA6FD,CArGD;;AAuGA,eAAeD,OAAf","sourcesContent":["import useLatest from '../useLatest';\nimport { getTargetElement } from '../utils/domTarget';\nimport useEffectWithTarget from '../utils/useEffectWithTarget';\nimport { useRef } from 'react';\n\nvar useDrop = function useDrop(target, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var optionsRef = useLatest(options); // https://stackoverflow.com/a/26459269\n\n  var dragEnterTarget = useRef();\n  useEffectWithTarget(function () {\n    var targetElement = getTargetElement(target);\n\n    if (!(targetElement === null || targetElement === void 0 ? void 0 : targetElement.addEventListener)) {\n      return;\n    }\n\n    var onData = function onData(dataTransfer, event) {\n      var uri = dataTransfer.getData('text/uri-list');\n      var dom = dataTransfer.getData('custom');\n\n      if (dom && optionsRef.current.onDom) {\n        var data = dom;\n\n        try {\n          data = JSON.parse(dom);\n        } catch (e) {\n          data = dom;\n        }\n\n        optionsRef.current.onDom(data, event);\n        return;\n      }\n\n      if (uri && optionsRef.current.onUri) {\n        optionsRef.current.onUri(uri, event);\n        return;\n      }\n\n      if (dataTransfer.files && dataTransfer.files.length && optionsRef.current.onFiles) {\n        optionsRef.current.onFiles(Array.from(dataTransfer.files), event);\n        return;\n      }\n\n      if (dataTransfer.items && dataTransfer.items.length && optionsRef.current.onText) {\n        dataTransfer.items[0].getAsString(function (text) {\n          optionsRef.current.onText(text, event);\n        });\n      }\n    };\n\n    var onDragEnter = function onDragEnter(event) {\n      var _a, _b;\n\n      event.preventDefault();\n      event.stopPropagation();\n      dragEnterTarget.current = event.target;\n      (_b = (_a = optionsRef.current).onDragEnter) === null || _b === void 0 ? void 0 : _b.call(_a, event);\n    };\n\n    var onDragOver = function onDragOver(event) {\n      var _a, _b;\n\n      event.preventDefault();\n      (_b = (_a = optionsRef.current).onDragOver) === null || _b === void 0 ? void 0 : _b.call(_a, event);\n    };\n\n    var onDragLeave = function onDragLeave(event) {\n      var _a, _b;\n\n      if (event.target === dragEnterTarget.current) {\n        (_b = (_a = optionsRef.current).onDragLeave) === null || _b === void 0 ? void 0 : _b.call(_a, event);\n      }\n    };\n\n    var onDrop = function onDrop(event) {\n      var _a, _b;\n\n      event.preventDefault();\n      onData(event.dataTransfer, event);\n      (_b = (_a = optionsRef.current).onDrop) === null || _b === void 0 ? void 0 : _b.call(_a, event);\n    };\n\n    var onPaste = function onPaste(event) {\n      var _a, _b;\n\n      onData(event.clipboardData, event);\n      (_b = (_a = optionsRef.current).onPaste) === null || _b === void 0 ? void 0 : _b.call(_a, event);\n    };\n\n    targetElement.addEventListener('dragenter', onDragEnter);\n    targetElement.addEventListener('dragover', onDragOver);\n    targetElement.addEventListener('dragleave', onDragLeave);\n    targetElement.addEventListener('drop', onDrop);\n    targetElement.addEventListener('paste', onPaste);\n    return function () {\n      targetElement.removeEventListener('dragenter', onDragEnter);\n      targetElement.removeEventListener('dragover', onDragOver);\n      targetElement.removeEventListener('dragleave', onDragLeave);\n      targetElement.removeEventListener('drop', onDrop);\n      targetElement.removeEventListener('paste', onPaste);\n    };\n  }, [], target);\n};\n\nexport default useDrop;"]},"metadata":{},"sourceType":"module"}