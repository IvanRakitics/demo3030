{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport React, { useState } from 'react';\nimport { mergeProps } from '../../utils/with-default-props';\nimport classNames from 'classnames';\nimport { useUnmountedRef } from 'ahooks';\nimport Mask from '../mask';\nimport { ModalActionButton } from './modal-action-button';\nimport Image from '../image';\nimport Space from '../space';\nimport { renderToContainer } from '../../utils/render-to-container';\nimport { withStopPropagation } from '../../utils/with-stop-propagation';\nimport AutoCenter from '../auto-center';\nimport { useSpring, animated } from '@react-spring/web';\nimport { withNativeProps } from '../../utils/native-props';\nimport { CloseOutline } from 'antd-mobile-icons';\nconst defaultProps = {\n  visible: false,\n  actions: [],\n  closeOnAction: false,\n  closeOnMaskClick: false,\n  stopPropagation: ['click'],\n  showCloseButton: false,\n  getContainer: null\n};\nexport const Modal = p => {\n  const props = mergeProps(defaultProps, p);\n  const unmountedRef = useUnmountedRef();\n  const style = useSpring({\n    scale: props.visible ? 1 : 0.8,\n    opacity: props.visible ? 1 : 0,\n    config: {\n      mass: 1.2,\n      tension: 200,\n      friction: 25,\n      clamp: true\n    },\n    onStart: () => {\n      setActive(true);\n    },\n    onRest: () => {\n      var _a, _b;\n\n      if (unmountedRef.current) return;\n      setActive(props.visible);\n\n      if (props.visible) {\n        (_a = props.afterShow) === null || _a === void 0 ? void 0 : _a.call(props);\n      } else {\n        (_b = props.afterClose) === null || _b === void 0 ? void 0 : _b.call(props);\n      }\n    }\n  });\n  const [active, setActive] = useState(props.visible);\n  const body = React.createElement(\"div\", {\n    className: classNames(cls('body'), props.image && cls('with-image'), props.bodyClassName),\n    style: props.bodyStyle\n  }, props.showCloseButton && React.createElement(\"a\", {\n    className: classNames(cls('close'), 'adm-plain-anchor'),\n    onClick: props.onClose\n  }, React.createElement(CloseOutline, null)), !!props.image && React.createElement(\"div\", {\n    className: cls('image-container')\n  }, React.createElement(Image, {\n    src: props.image,\n    alt: 'modal header image',\n    width: '100%'\n  })), !!props.header && React.createElement(\"div\", {\n    className: cls('header')\n  }, React.createElement(AutoCenter, null, props.header)), !!props.title && React.createElement(\"div\", {\n    className: cls('title')\n  }, props.title), React.createElement(\"div\", {\n    className: cls('content')\n  }, typeof props.content === 'string' ? React.createElement(AutoCenter, null, props.content) : props.content), React.createElement(Space, {\n    direction: 'vertical',\n    block: true,\n    className: classNames(cls('footer'), props.actions.length === 0 && cls('footer-empty'))\n  }, props.actions.map((action, index) => {\n    return React.createElement(ModalActionButton, {\n      key: action.key,\n      action: action,\n      onAction: () => __awaiter(void 0, void 0, void 0, function* () {\n        var _a, _b, _c;\n\n        yield Promise.all([(_a = action.onClick) === null || _a === void 0 ? void 0 : _a.call(action), (_b = props.onAction) === null || _b === void 0 ? void 0 : _b.call(props, action, index)]);\n\n        if (props.closeOnAction) {\n          (_c = props.onClose) === null || _c === void 0 ? void 0 : _c.call(props);\n        }\n      })\n    });\n  })));\n  const node = withStopPropagation(props.stopPropagation, withNativeProps(props, React.createElement(\"div\", {\n    className: cls(),\n    style: {\n      display: active ? 'unset' : 'none'\n    }\n  }, React.createElement(Mask, {\n    visible: props.visible,\n    onMaskClick: props.closeOnMaskClick ? props.onClose : undefined,\n    style: props.maskStyle,\n    className: classNames(cls('mask'), props.maskClassName)\n  }), React.createElement(\"div\", {\n    className: cls('wrap'),\n    style: {\n      pointerEvents: props.visible ? 'unset' : 'none'\n    }\n  }, React.createElement(animated.div, {\n    style: style\n  }, body)))));\n  return renderToContainer(props.getContainer, node);\n};\n\nfunction cls() {\n  let name = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  return 'adm-modal' + (name && '-') + name;\n}","map":{"version":3,"sources":["D:/react/project0330/node_modules/antd-mobile/es/components/modal/modal.js"],"names":["__awaiter","React","useState","mergeProps","classNames","useUnmountedRef","Mask","ModalActionButton","Image","Space","renderToContainer","withStopPropagation","AutoCenter","useSpring","animated","withNativeProps","CloseOutline","defaultProps","visible","actions","closeOnAction","closeOnMaskClick","stopPropagation","showCloseButton","getContainer","Modal","p","props","unmountedRef","style","scale","opacity","config","mass","tension","friction","clamp","onStart","setActive","onRest","_a","_b","current","afterShow","call","afterClose","active","body","createElement","className","cls","image","bodyClassName","bodyStyle","onClick","onClose","src","alt","width","header","title","content","direction","block","length","map","action","index","key","onAction","_c","Promise","all","node","display","onMaskClick","undefined","maskStyle","maskClassName","pointerEvents","div","name"],"mappings":"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","sourcesContent":["import { __awaiter } from \"tslib\";\nimport React, { useState } from 'react';\nimport { mergeProps } from '../../utils/with-default-props';\nimport classNames from 'classnames';\nimport { useUnmountedRef } from 'ahooks';\nimport Mask from '../mask';\nimport { ModalActionButton } from './modal-action-button';\nimport Image from '../image';\nimport Space from '../space';\nimport { renderToContainer } from '../../utils/render-to-container';\nimport { withStopPropagation } from '../../utils/with-stop-propagation';\nimport AutoCenter from '../auto-center';\nimport { useSpring, animated } from '@react-spring/web';\nimport { withNativeProps } from '../../utils/native-props';\nimport { CloseOutline } from 'antd-mobile-icons';\nconst defaultProps = {\n  visible: false,\n  actions: [],\n  closeOnAction: false,\n  closeOnMaskClick: false,\n  stopPropagation: ['click'],\n  showCloseButton: false,\n  getContainer: null\n};\nexport const Modal = p => {\n  const props = mergeProps(defaultProps, p);\n  const unmountedRef = useUnmountedRef();\n  const style = useSpring({\n    scale: props.visible ? 1 : 0.8,\n    opacity: props.visible ? 1 : 0,\n    config: {\n      mass: 1.2,\n      tension: 200,\n      friction: 25,\n      clamp: true\n    },\n    onStart: () => {\n      setActive(true);\n    },\n    onRest: () => {\n      var _a, _b;\n\n      if (unmountedRef.current) return;\n      setActive(props.visible);\n\n      if (props.visible) {\n        (_a = props.afterShow) === null || _a === void 0 ? void 0 : _a.call(props);\n      } else {\n        (_b = props.afterClose) === null || _b === void 0 ? void 0 : _b.call(props);\n      }\n    }\n  });\n  const [active, setActive] = useState(props.visible);\n  const body = React.createElement(\"div\", {\n    className: classNames(cls('body'), props.image && cls('with-image'), props.bodyClassName),\n    style: props.bodyStyle\n  }, props.showCloseButton && React.createElement(\"a\", {\n    className: classNames(cls('close'), 'adm-plain-anchor'),\n    onClick: props.onClose\n  }, React.createElement(CloseOutline, null)), !!props.image && React.createElement(\"div\", {\n    className: cls('image-container')\n  }, React.createElement(Image, {\n    src: props.image,\n    alt: 'modal header image',\n    width: '100%'\n  })), !!props.header && React.createElement(\"div\", {\n    className: cls('header')\n  }, React.createElement(AutoCenter, null, props.header)), !!props.title && React.createElement(\"div\", {\n    className: cls('title')\n  }, props.title), React.createElement(\"div\", {\n    className: cls('content')\n  }, typeof props.content === 'string' ? React.createElement(AutoCenter, null, props.content) : props.content), React.createElement(Space, {\n    direction: 'vertical',\n    block: true,\n    className: classNames(cls('footer'), props.actions.length === 0 && cls('footer-empty'))\n  }, props.actions.map((action, index) => {\n    return React.createElement(ModalActionButton, {\n      key: action.key,\n      action: action,\n      onAction: () => __awaiter(void 0, void 0, void 0, function* () {\n        var _a, _b, _c;\n\n        yield Promise.all([(_a = action.onClick) === null || _a === void 0 ? void 0 : _a.call(action), (_b = props.onAction) === null || _b === void 0 ? void 0 : _b.call(props, action, index)]);\n\n        if (props.closeOnAction) {\n          (_c = props.onClose) === null || _c === void 0 ? void 0 : _c.call(props);\n        }\n      })\n    });\n  })));\n  const node = withStopPropagation(props.stopPropagation, withNativeProps(props, React.createElement(\"div\", {\n    className: cls(),\n    style: {\n      display: active ? 'unset' : 'none'\n    }\n  }, React.createElement(Mask, {\n    visible: props.visible,\n    onMaskClick: props.closeOnMaskClick ? props.onClose : undefined,\n    style: props.maskStyle,\n    className: classNames(cls('mask'), props.maskClassName)\n  }), React.createElement(\"div\", {\n    className: cls('wrap'),\n    style: {\n      pointerEvents: props.visible ? 'unset' : 'none'\n    }\n  }, React.createElement(animated.div, {\n    style: style\n  }, body)))));\n  return renderToContainer(props.getContainer, node);\n};\n\nfunction cls(name = '') {\n  return 'adm-modal' + (name && '-') + name;\n}"]},"metadata":{},"sourceType":"module"}